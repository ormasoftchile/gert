{
  "name": "gert-vscode",
  "displayName": "gert — TSG Runner",
  "description": "VS Code extension for governed executable TSGs",
  "version": "0.1.0",
  "publisher": "ormasoftchile",
  "engines": {
    "vscode": "^1.85.0"
  },
  "categories": [
    "Linters",
    "Other"
  ],
  "activationEvents": [
    "onLanguage:yaml"
  ],
  "main": "./dist/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "gert.validateRunbook",
        "title": "Gert: Validate TSG"
      },
      {
        "command": "gert.runTsg",
        "title": "Gert: Run TSG",
        "icon": "$(play)"
      },
      {
        "command": "gert.runTests",
        "title": "Gert: Run Tests",
        "icon": "$(beaker)"
      }
    ],
    "menus": {
      "editor/title": [
        {
          "when": "resourceLangId == markdown",
          "command": "gert.runTsg",
          "group": "navigation"
        },
        {
          "when": "resourceFilename =~ /\\.runbook\\.(yaml|yml)$/",
          "command": "gert.runTsg",
          "group": "navigation"
        },
        {
          "when": "resourceFilename =~ /\\.runbook\\.(yaml|yml)$/",
          "command": "gert.runTests",
          "group": "navigation"
        }
      ],
      "explorer/context": [
        {
          "when": "resourceLangId == markdown",
          "command": "gert.runTsg",
          "group": "gert@1"
        },
        {
          "when": "resourceFilename =~ /\\.runbook\\.(yaml|yml)$/",
          "command": "gert.runTsg",
          "group": "gert@1"
        },
        {
          "when": "resourceFilename =~ /\\.runbook\\.(yaml|yml)$/",
          "command": "gert.runTests",
          "group": "gert@2"
        }
      ]
    },
    "languages": [
      {
        "id": "yaml",
        "extensions": [
          ".yaml",
          ".yml"
        ]
      }
    ],
    "grammars": [
      {
        "scopeName": "runbook.injection",
        "path": "./syntaxes/runbook-injection.json",
        "injectTo": ["source.yaml"]
      },
      {
        "scopeName": "runbook.block.injection",
        "path": "./syntaxes/kusto-sql-block.injection.json",
        "injectTo": ["source.yaml"],
        "embeddedLanguages": {
          "keyword.other.kusto": "kusto",
          "keyword.other.sql": "sql"
        }
      }
    ],
    "jsonValidation": [
      {
        "fileMatch": [
          "**/runbook*.yaml",
          "**/runbook*.yml",
          "**/*.runbook.yaml"
        ],
        "url": "./schemas/runbook-v0.json"
      },
      {
        "fileMatch": [
          "**/*.tool.yaml",
          "**/*.tool.yml"
        ],
        "url": "./schemas/tool-v0.json"
      }
    ],
    "configuration": {
      "title": "Gert",
      "properties": {
        "gert.binaryPath": {
          "type": "string",
          "default": "gert",
          "description": "Path to the gert binary. Defaults to 'gert' (found via PATH)."
        },
        "gert.autoAdvanceMode": {
          "type": "string",
          "enum": ["animated", "summary", "manual"],
          "default": "animated",
          "enumDescriptions": [
            "Auto-advance routing steps with a brief pause (200ms) so each step flashes in the map",
            "Auto-advance instantly but show a summary of skipped steps",
            "No auto-advance — click through every step including routing ones"
          ],
          "description": "How to handle routing steps that don't require user input."
        },
        "gert.summaryIncludeQueries": {
          "type": "boolean",
          "default": true,
          "description": "Include the full Kusto/SQL query text in the execution summary."
        },
        "gert.showStepNumbers": {
          "type": "boolean",
          "default": true,
          "description": "Show TSG and step numbers (1. TSG Name, 1.1 Step, 1.2 Step, 2.1 Step, etc.) in the workflow map."
        }
      }
    }
  },
  "scripts": {
    "compile": "esbuild src/extension.ts --bundle --outdir=dist --external:vscode --format=cjs --platform=node",
    "watch": "esbuild src/extension.ts --bundle --outdir=dist --external:vscode --format=cjs --platform=node --watch",
    "test": "jest --config jest.config.js",
    "lint": "eslint src/"
  },
  "devDependencies": {
    "@types/jest": "^29.5.0",
    "@types/node": "^20.0.0",
    "@types/vscode": "^1.85.0",
    "esbuild": "^0.20.0",
    "eslint": "^8.57.0",
    "jest": "^29.7.0",
    "ts-jest": "^29.1.0",
    "typescript": "^5.4.0"
  },
  "dependencies": {
    "ajv": "^8.12.0",
    "ajv-formats": "^3.0.0",
    "highlight.js": "^11.11.1",
    "marked": "^17.0.2",
    "yaml": "^2.8.2"
  }
}
