apiVersion: runbook/v0
meta:
  name: all-assertions
  description: Exercise all 7 assertion types
  vars:
    host: localhost
steps:
  - id: check_health
    type: cli
    title: Health check
    with:
      argv: ["curl", "-s", "http://{{ .host }}/health"]
    capture:
      health: stdout
    assertions:
      - contains: "healthy"
      - not_contains: "error"
      - matches: "status.*ok"
      - exit_code: 0
      - json_path:
          path: "$.status"
          equals: "ok"

  - id: check_version
    type: cli
    title: Version check
    with:
      argv: ["curl", "-s", "http://{{ .host }}/version"]
    capture:
      version: stdout
    assertions:
      - equals: "v1.0.0"

  - id: check_not_deprecated
    type: cli
    title: Deprecation check
    with:
      argv: ["curl", "-s", "http://{{ .host }}/info"]
    capture:
      info: stdout
    assertions:
      - not_equals: "deprecated"
