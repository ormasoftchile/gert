apiVersion: tool/v0

meta:
  name: nslookup
  description: Query DNS to obtain domain name or IP address mappings
  binary: nslookup
  transport: stdio

contract:
  effects: [network]
  writes: []
  idempotent: true
  deterministic: false
  inputs:
    host:
      type: string
      required: true
  outputs:
    resolved_ip:
      type: string
    result:
      type: string

actions:
  lookup:
    description: Resolve a hostname to its IP address(es)
    argv: ["{{ .host }}"]
    extract:
      resolved_ip:
        from: stdout
      result:
        from: stdout

  lookup-server:
    description: Resolve a hostname using a specific DNS server
    argv: ["{{ .host }}", "{{ .server }}"]
    extract:
      resolved_ip:
        from: stdout
      result:
        from: stdout

  reverse:
    description: Perform a reverse DNS lookup for an IP address
    argv: ["-type=PTR", "{{ .ip }}"]
    extract:
      result:
        from: stdout

  query-type:
    description: Query a specific DNS record type
    argv: ["-type={{ .record_type }}", "{{ .host }}"]
    extract:
      result:
        from: stdout
