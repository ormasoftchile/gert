apiVersion: tool/v0

meta:
  name: ping
  description: Send ICMP ECHO_REQUEST packets to a host to test reachability
  binary: ping
  transport: stdio

contract:
  effects: [network]
  writes: []
  idempotent: true
  deterministic: false
  inputs:
    host:
      type: string
      required: true
  outputs:
    result:
      type: string

actions:
  check:
    description: Ping a host a fixed number of times and report results
    argv: ["-n", "{{ .count }}", "{{ .host }}"]
    extract:
      result:
        from: stdout

  check-timeout:
    description: Ping a host with a deadline (seconds) and report results
    argv: ["-n", "{{ .count }}", "-w", "{{ .timeout }}", "{{ .host }}"]
    extract:
      result:
        from: stdout
